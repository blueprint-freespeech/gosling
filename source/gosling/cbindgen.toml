# see https://github.com/eqrion/cbindgen/blob/master/docs.md

# platform defines derived from: https://loumalouomega.github.io/OSPreprocessor/

header ="""
// libgosling header autogenerated by cbindgen, do not modify
"""

after_includes = """
#if (defined(_WIN32) || defined(_WIN64))
#   define GOSLING_PLATFORM_WINDOWS
#elif (defined(__linux__) || defined(__linux) || defined(linux) || defined(__gnu_linux__))
#   define GOSLING_PLATFORM_LINUX
#elif (defined(__APPLE__) && defined(__MACH__))
#   define GOSLING_PLATFORM_MACOS
#endif

#if defined(GOSLING_PLATFORM_WINDOWS)
#   include <winsock2.h>
#elif defined(GOSLING_PLATFORM_LINUX) || defined(GOSLING_PLATFORM_MACOS)
#   include <sys/socket.h>
#endif
"""

tab_width = 4
language = "C"
cpp_compat = true
include_guard = "LIBGOSLING_H"
usize_is_size_t = true
documentation = true
documentation_style = "c99"
line_length = 80
only_target_dependencies = true

[defines]
"windows" = "GOSLING_PLATFORM_WINDOWS"
"linux" = "GOSLING_PLATFORM_LINUX"
"macos" = "GOSLING_PLATFORM_MACOS"

[fn]
args = "vertical"

[enum]
rename_variants = "SnakeCase"

[export.rename]
"RawSocket" = "SOCKET"
"RawFd" = "int"

# structs
"GoslingError" = "gosling_error"
"GoslingEd25519PrivateKey" = "gosling_ed25519_private_key"
"GoslingEd25519PublicKey" = "gosling_ed25519_public_key"
"GoslingX25519PrivateKey" = "gosling_x25519_private_key"
"GoslingX25519PublicKey" = "gosling_x25519_public_key"
"GoslingV3OnionServiceId" = "gosling_v3_onion_service_id"
"GoslingContext" = "gosling_context"

# enums
"ChallengeResponseResult" = "gosling_challenge_response_result_t"

# server handshake callbacks
"GoslingHandshakeStartedServerCallback" = "gosling_handshake_started_server_callback_t"
"GoslingHandshakeEndpointSupportedCallback" = "gosling_handshake_endpoint_supported_callback_t"
"GoslingHandshakeChallengeSizeCallback" = "gosling_handshake_challenge_size_callback_t"
"GoslingHandshakeBuildChallengeCallback" = "gosling_handshake_build_challenge_callback_t"
"GoslingHandshakePollChallengeResponseResultCallback" = "gosling_handshake_poll_challenge_response_result_callback_t"

# client handshake callbacks
"GoslingHandshakeStartedClientCallback" = "gosling_handshake_started_client_callback_t"
"GoslingHandshakeBuildResponseSizeCallback" = "gosling_handshake_build_response_size_callback_t"
"GoslingHandshakeBuildResponseCallback" = "gosling_handshake_build_response_callback_t"

# see https://github.com/eqrion/cbindgen/blob/master/docs.md

# platform defines derived from: https://loumalouomega.github.io/OSPreprocessor/

header ="""// libgosling header autogenerated by cbindgen, do not modify"""

after_includes = """
// gosling platform defines
#if (defined(_WIN32) || defined(_WIN64))
#   define GOSLING_PLATFORM_WINDOWS
#elif (defined(__linux__) || defined(__linux) || defined(linux) || defined(__gnu_linux__))
#   define GOSLING_PLATFORM_LINUX
#elif (defined(__APPLE__) && defined(__MACH__))
#   define GOSLING_PLATFORM_MACOS
#endif

// per-platform includes
#if defined(GOSLING_PLATFORM_WINDOWS)
#   include <winsock2.h>
#elif defined(GOSLING_PLATFORM_LINUX) || defined(GOSLING_PLATFORM_MACOS)
#   include <sys/socket.h>
#endif
"""

tab_width = 4
language = "C"
cpp_compat = true
include_guard = "LIBGOSLING_H"
usize_is_size_t = true
documentation = true
documentation_style = "c99"
line_length = 80
only_target_dependencies = true

[defines]
"target_os = windows" = "GOSLING_PLATFORM_WINDOWS"
"target_os = linux" = "GOSLING_PLATFORM_LINUX"
"target_os = macos" = "GOSLING_PLATFORM_MACOS"

[fn]
args = "vertical"

[enum]
rename_variants = "SnakeCase"
enum_class = true
prefix_with_name = true

[export.rename]
"RawSocket" = "SOCKET"
"RawFd" = "int"

# typedef
GoslingHandshakehandle = "gosling_handshake_handle_t"

# structs
"GoslingLibrary" = "gosling_library"
"GoslingError" = "gosling_error"
"GoslingEd25519PrivateKey" = "gosling_ed25519_private_key"
"GoslingEd25519PublicKey" = "gosling_ed25519_public_key"
"GoslingX25519PrivateKey" = "gosling_x25519_private_key"
"GoslingX25519PublicKey" = "gosling_x25519_public_key"
"GoslingV3OnionServiceId" = "gosling_v3_onion_service_id"
"GoslingContext" = "gosling_context"
"GoslingIdentityClientHandshake" = "gosling_identity_client_handshake"
"GoslingIdentityServerHandshake" = "gosling_identity_server_handshake"

# enums
"GoslingChallengeResponseResult" = "gosling_challenge_response_result"
"GoslingChallengeResponseResultT" = "gosling_challenge_response_result_t"

# client handshake callbacks
"GoslingIdentityClientHandshakeInitCallback" = "gosling_identity_client_handshake_init_callback_t"
"GoslingIdentityClientHandshakeFreeCallback" = "gosling_identity_client_handshake_free_callback_t"
"GoslingIdentityClientHandshakeChallengeResponseSizeCallback" = "gosling_identity_client_handshake_challenge_response_size_callback_t"
"GoslingIdentityClientHandshakeBuildChallengeResponseCallback" = "gosling_identity_client_handshake_build_challenge_response_callback_t"

# server handshake callbacks
"GoslingIdentityServerHandshakeInitCallback" = "gosling_identity_server_handshake_init_callback_t"
"GoslingIdentityServerHandshakeFreeCallback" = "gosling_identity_server_handshake_free_callback_t"
"GoslingIdentityServerHandshakeEndpointSupportedCallback" = "gosling_identity_server_handshake_endpoint_supported_callback_t"
"GoslingIdentityServerHandshakeChallengeSizeCallback" = "gosling_identity_server_handshake_challenge_size_callback_t"
"GoslingIdentityServerHandshakeBuildChallengeCallback" = "gosling_identity_server_handshake_build_challenge_callback_t"
"GoslingIdentityServerHandshakeVerifyChallengeResponseCallback" = "gosling_identity_server_handshake_verify_challenge_response_callback_t"
"GoslingIdentityServerHandshakePollChallengeResponseResultCallback" = "gosling_identity_server_handshake_poll_challenge_response_result_callback_t"

# context event callbacks
"GoslingTorBootstrapStatusReceivedCallback" = "gosling_tor_bootstrap_status_received_callback_t"
"GoslingTorBootstrapCompletedCallback" = "gosling_tor_bootstrap_completed_callback_t"
"GoslingTorLogRecieved" = "gosling_tor_log_received_callback_t"
"GoslingIdentityServerPublishedCallback" = "gosling_identity_server_published_callback_t"
"GoslingEndpointServerPublishedCallback" = "gosling_endpoint_server_published_callback_t"
"GoslingEndpointClientRequestCompletedCallback" = "gosling_endpoint_client_request_completed_callback_t"
"GoslingEndpointServerRequestCompletedCallback" = "gosling_endpoint_server_request_completed_callback_t"
"GoslingEndpointClientChannelRequestCompletedCallback" = "gosling_endpoint_client_channel_request_completed_callback_t"
"GoslingEndpointServerChannelRequestCompletedCallback" = "gosling_endpoint_server_channel_request_completed_callback_t"


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Gosling | News</title>
  <link rel="icon" type="image/x-icon" href="images/favicon.png" />
  <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
  <div class="container">
    <div class="navigation">
      <div class="logo">
        <a href="index.xhtml"><img src="images/gosling-square-small-opt.svg" alt="Gosling Icon" /></a>
      </div>
      <h2>Navigation</h2>
      <ul>
        <li><a href="news.xhtml">News</a></li>
        <li><a href="https://github.com/blueprint-freespeech/gosling">GitHub</a></li>
        <li><a href="coverage.html">Test Coverage</a></li>
        <li>Crate Docs
          <ul>
            <li><a href="crates/gosling/index.html">gosling</a></li>
            <li><a href="crates/tor_interface/index.html">tor-interface</a></li>
            <li><a href="crates/honk_rpc/index.html">honk-rpc</a></li>
          </ul>
        </li>
        <li><a href="cgosling/index.html">C/C++ Docs</a></li>
        <li>Protocol Specs
          <ul>
            <li><a href="honk-rpc-spec.xhtml">Honk-RPC</a></li>
            <li><a href="gosling-spec.xhtml">Gosling</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="content">
      <h1 id="news">News</h1>
      <hr />
      <h2 id="debian-source-packages">2024-02-28 - Debian Source Packages</h2>
      <p>This past week I’ve been diving into the wonderful world of debian packaging. Specifically, constructing a debian source package via CMake which can be used to build the cgosling library from source, and generate both binary and dev packages.</p>
      <p>This exercise has been a bit difficult for a few reasons:</p>
      <ul>
      <li>I knew almost nothing about debian source packing at the start of this process.</li>
      <li>The current debian stable only has rustc version 1.63 in the apt repositories, which means I had to make some changes to remove the rustc 1.66 dependency.</li>
      <li>An upstream bug in cargo (<a href="https://github.com/rust-lang/cargo/issues/5045">rust-lang/cargo#5045 - Support soname for cdylibs</a>) meant following the debian documentation results in deb packages with lintian errors.</li>
      </ul>
      <p>This last issue proved to be the most time consuming. Essentially, the debian tools used to generate a binary package from a source package depend on the presence of the soname metadata field in the provided elf binaries to trigger a call to ldconfig on package installation. This ldconfig step essentially updates some data-store which tells the runtime linker what runtime libraries are available, as well as their versions. However, the rust toolchain does not set this metadata field for cdylib targets like it should. This resulted in libraries which the debian tools did not realise were libraries</p>
      <p>To work around this, I have added a patchelf step which updates this soname field manually for Linux builds. I have also renamed the Linux shared-library target to include full semantic version at the end (libcgosling.so.0.2.1) and added symlinks to this library in the standard format (libcsogling.so and libcgosling.so.0) to play nicely in actual deployments.</p>
      <p>As part of this, I have also moved the crate’s semantic version definition out of its Cargo.toml file, and instead into the CMake part of the build-system. This way, we can generate all the various files (Cargo.toml, debian/control, debian/rules, etc) which need the semantic and major versions.</p>
      <p>With commit <a href="https://github.com/blueprint-freespeech/gosling/commit/7944370a122905b52640d87b5a8e17b2f3e5c53a">5ae906c</a>, we are now able to build debian source packages, and end-users can build binary and dev packages. This is the first step in eventually getting cgosling into debian. Hopefully it will be all the easier by having a properly formatted (with no lintian errors!) source package to start from.</p>
      <h2 id="fosdem">2024-02-01 - FOSDEM!</h2>
      <p>The Blueprint for Free Speech’s Gosling and Ricochet Refresh team is going to Brussels to attend one of the world’s largest free software events – <a href="https://fosdem.org/2024/">FOSDEM 2024</a></p>
      <p>We’ll be sharing our progress on Gosling and <a href="https://ricochetrefresh.net">Ricochet Refresh</a>, as well as exploring what the rest of the community is busy building.</p>
      <p>Drop by if you can to FOSDEM - it’s free!</p>
      <h2 id="no-news-is-good-news">2023-07-04 - No news is good news!</h2>
      <p>Nothing to report here.</p>
      <hr/>
      <footer>
        <p>&copy; 2023 <a href="https://www.blueprintforfreespeech.net">Blueprint for Free Speech</a>. All rights reserved.</p>
      </footer>
    </div>
  </div>
</body>
</html>


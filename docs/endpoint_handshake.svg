<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="976px" preserveAspectRatio="none" style="width:372px;height:976px;" version="1.1" viewBox="0 0 372 976" width="372px" zoomAndPan="magnify"><defs><filter height="300%" id="fq8jirem6j8tp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fq8jirem6j8tp)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="123.5625"/><rect fill="#FFFFFF" filter="url(#fq8jirem6j8tp)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="262.0938"/><rect fill="#FFFFFF" filter="url(#fq8jirem6j8tp)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="458.8906"/><rect fill="#FFFFFF" filter="url(#fq8jirem6j8tp)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="655.6875"/><rect fill="#FFFFFF" filter="url(#fq8jirem6j8tp)" height="56.2656" style="stroke: #000000; stroke-width: 2.0;" width="285" x="76" y="794.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="72" x2="72" y1="38.2969" y2="935.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="218.5" x2="218.5" y1="38.2969" y2="935.75"/><rect fill="#FEFECE" filter="url(#fq8jirem6j8tp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="44" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="51" y="22.9951">Client</text><rect fill="#FEFECE" filter="url(#fq8jirem6j8tp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="44" y="934.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="51" y="954.7451">Client</text><rect fill="#FEFECE" filter="url(#fq8jirem6j8tp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="154.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="161.5" y="22.9951">Endpoint Server</text><rect fill="#FEFECE" filter="url(#fq8jirem6j8tp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="124" x="154.5" y="934.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="161.5" y="954.7451">Endpoint Server</text><polygon fill="#A80036" points="206.5,65.4297,216.5,69.4297,206.5,73.4297,210.5,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="212.5" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="79.5" y="64.3638">begin_handshake()</text><path d="M124,82.4297 L124,107.4297 L308,107.4297 L308,92.4297 L298,82.4297 L124,82.4297 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M298,82.4297 L298,92.4297 L308,92.4297 L298,82.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="130" y="99.4966">Evaluate Protocol Version</text><path d="M34,123.5625 L98,123.5625 L98,130.5625 L88,140.5625 L34,140.5625 L34,123.5625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="123.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="49" y="136.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="113" y="135.7729">[Unsupported Version]</text><polygon fill="#A80036" points="83.5,157.8281,73.5,161.8281,83.5,165.8281,79.5,161.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="161.8281" y2="161.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="89.5" y="156.7622">error</text><path d="M150,174.8281 L150,199.8281 L282,199.8281 L282,184.8281 L272,174.8281 L150,174.8281 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272,174.8281 L272,184.8281 L282,184.8281 L272,174.8281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="156" y="191.895">Close Connection</text><path d="M135,220.9609 L135,245.9609 L298,245.9609 L298,230.9609 L288,220.9609 L135,220.9609 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M288,220.9609 L288,230.9609 L298,230.9609 L288,220.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="141" y="238.0278">Check Client Allow-List</text><path d="M34,262.0938 L98,262.0938 L98,269.0938 L88,279.0938 L34,279.0938 L34,262.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="49" y="275.1606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="113" y="274.3042">[Client Blocked]</text><polygon fill="#A80036" points="83.5,296.3594,73.5,300.3594,83.5,304.3594,79.5,300.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="300.3594" y2="300.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="89.5" y="295.2935">error</text><path d="M150,313.3594 L150,338.3594 L282,338.3594 L282,323.3594 L272,313.3594 L150,313.3594 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272,313.3594 L272,323.3594 L282,323.3594 L272,313.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="156" y="330.4263">Close Connection</text><polygon fill="#A80036" points="83.5,371.625,73.5,375.625,83.5,379.625,79.5,375.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="375.625" y2="375.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="89.5" y="370.5591">return</text><polygon fill="#A80036" points="206.5,400.7578,216.5,404.7578,206.5,408.7578,210.5,404.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="212.5" y1="404.7578" y2="404.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="79.5" y="399.6919">send_client_proof()</text><path d="M140,417.7578 L140,442.7578 L293,442.7578 L293,427.7578 L283,417.7578 L140,417.7578 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M283,417.7578 L283,427.7578 L293,427.7578 L283,417.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="146" y="434.8247">Evaluate Client Proof</text><path d="M34,458.8906 L98,458.8906 L98,465.8906 L88,475.8906 L34,475.8906 L34,458.8906 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="458.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="49" y="471.9575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="113" y="471.1011">[Invalid Proof]</text><polygon fill="#A80036" points="83.5,493.1563,73.5,497.1563,83.5,501.1563,79.5,497.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="497.1563" y2="497.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="89.5" y="492.0903">error</text><path d="M150,510.1563 L150,535.1563 L282,535.1563 L282,520.1563 L272,510.1563 L150,510.1563 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272,510.1563 L272,520.1563 L282,520.1563 L272,510.1563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="156" y="527.2231">Close Connection</text><polygon fill="#A80036" points="83.5,568.4219,73.5,572.4219,83.5,576.4219,79.5,572.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="572.4219" y2="572.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="89.5" y="567.356">return</text><polygon fill="#A80036" points="206.5,597.5547,216.5,601.5547,206.5,605.5547,210.5,601.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="212.5" y1="601.5547" y2="601.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="79.5" y="596.4888">open_endpoint()</text><path d="M148,614.5547 L148,639.5547 L284,639.5547 L284,624.5547 L274,614.5547 L148,614.5547 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M274,614.5547 L274,624.5547 L284,624.5547 L274,614.5547 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="154" y="631.6216">Evaluate Endpoint</text><path d="M34,655.6875 L98,655.6875 L98,662.6875 L88,672.6875 L34,672.6875 L34,655.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="262" x="34" y="655.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="49" y="668.7544">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="165" x="113" y="667.8979">[Invalid Service Endpoint]</text><polygon fill="#A80036" points="83.5,689.9531,73.5,693.9531,83.5,697.9531,79.5,693.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="693.9531" y2="693.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="89.5" y="688.8872">error</text><path d="M150,706.9531 L150,731.9531 L282,731.9531 L282,716.9531 L272,706.9531 L150,706.9531 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272,706.9531 L272,716.9531 L282,716.9531 L272,706.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="156" y="724.02">Close Connection</text><path d="M150,753.0859 L150,778.0859 L282,778.0859 L282,763.0859 L272,753.0859 L150,753.0859 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M272,753.0859 L272,763.0859 L282,763.0859 L272,753.0859 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="156" y="770.1528">Evaluate Channel</text><path d="M76,794.2188 L140,794.2188 L140,801.2188 L130,811.2188 L76,811.2188 L76,794.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="56.2656" style="stroke: #000000; stroke-width: 2.0;" width="285" x="76" y="794.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="91" y="807.2856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="155" y="806.4292">[Channel Already Open]</text><path d="M86,816.3516 L86,841.3516 L347,841.3516 L347,826.3516 L337,816.3516 L86,816.3516 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M337,816.3516 L337,826.3516 L347,826.3516 L337,816.3516 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="92" y="833.4185">Close Existing Connection on Channel</text><polygon fill="#A80036" points="83.5,874.6172,73.5,878.6172,83.5,882.6172,79.5,878.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="77.5" x2="217.5" y1="878.6172" y2="878.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="89.5" y="873.5513">return</text><path d="M8,891.6172 L8,916.6172 L280,916.6172 L280,901.6172 L270,891.6172 L8,891.6172 " fill="#FBFB77" filter="url(#fq8jirem6j8tp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M270,891.6172 L270,901.6172 L280,901.6172 L270,891.6172 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="14" y="908.6841">RPC session handed over to application</text><!--
@startuml
participant Client
participant "Endpoint Server" as Server

Client->Server: begin_handshake()

    note over Server: Evaluate Protocol Version

    alt Unsupported Version
        Client<-Server: error
        note over Server: Close Connection
    end

    note over Server: Check Client Allow-List

    alt Client Blocked
        Client<-Server: error
        note over Server: Close Connection
    end

Client<-Server: return

Client->Server: send_client_proof()

    note over Server: Evaluate Client Proof

    alt Invalid Proof
        Client<-Server: error
        note over Server: Close Connection
    end

Server->Client: return

Client->Server: open_endpoint()
    note over Server: Evaluate Endpoint

    alt Invalid Service Endpoint
        Client<-Server: error
        note over Server: Close Connection
    end

    note over Server: Evaluate Channel

    alt Channel Already Open
        note over Server: Close Existing Connection on Channel
    end

    Client<-Server: return

note over Client,Server: RPC session handed over to application

@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.14.1+1-Ubuntu-0ubuntu1.20.04
Operating System: Linux
OS Version: 5.13.0-39-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
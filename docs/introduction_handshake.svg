<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1287px" preserveAspectRatio="none" style="width:486px;height:1287px;" version="1.1" viewBox="0 0 486 1287" width="486px" zoomAndPan="magnify"><defs><filter height="300%" id="fl97i9wnsyf5c" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="123.5625"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="262.0938"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="458.8906"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="603.5234" style="stroke: #000000; stroke-width: 2.0;" width="463" x="12" y="587.4219"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="679.8203"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="818.3516"/><rect fill="#FFFFFF" filter="url(#fl97i9wnsyf5c)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="976.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="78" x2="78" y1="38.2969" y2="1247.0781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="340" x2="340" y1="38.2969" y2="1247.0781"/><rect fill="#FEFECE" filter="url(#fl97i9wnsyf5c)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="50" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="57" y="22.9951">Client</text><rect fill="#FEFECE" filter="url(#fl97i9wnsyf5c)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="50" y="1246.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="57" y="1266.0732">Client</text><rect fill="#FEFECE" filter="url(#fl97i9wnsyf5c)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="266" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="131" x="273" y="22.9951">Introduction Server</text><rect fill="#FEFECE" filter="url(#fl97i9wnsyf5c)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="145" x="266" y="1246.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="131" x="273" y="1266.0732">Introduction Server</text><polygon fill="#A80036" points="328.5,65.4297,338.5,69.4297,328.5,73.4297,332.5,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="334.5" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="85.5" y="64.3638">begin_handshake()</text><path d="M246,82.4297 L246,107.4297 L430,107.4297 L430,92.4297 L420,82.4297 L246,82.4297 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M420,82.4297 L420,92.4297 L430,92.4297 L420,82.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="252" y="99.4966">Evaluate Protocol Version</text><path d="M40,123.5625 L104,123.5625 L104,130.5625 L94,140.5625 L40,140.5625 L40,123.5625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="123.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="136.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="119" y="135.7729">[Unsupported Version]</text><polygon fill="#A80036" points="89.5,157.8281,79.5,161.8281,89.5,165.8281,85.5,161.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="161.8281" y2="161.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="95.5" y="156.7622">error</text><path d="M272,174.8281 L272,199.8281 L404,199.8281 L404,184.8281 L394,174.8281 L272,174.8281 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394,174.8281 L394,184.8281 L404,184.8281 L394,174.8281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="278" y="191.895">Close Connection</text><path d="M256,220.9609 L256,245.9609 L421,245.9609 L421,230.9609 L411,220.9609 L256,220.9609 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M411,220.9609 L411,230.9609 L421,230.9609 L411,220.9609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="262" y="238.0278">Check Client Block-List</text><path d="M40,262.0938 L104,262.0938 L104,269.0938 L94,279.0938 L40,279.0938 L40,262.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="275.1606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="119" y="274.3042">[Client Blocked]</text><polygon fill="#A80036" points="89.5,296.3594,79.5,300.3594,89.5,304.3594,85.5,300.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="300.3594" y2="300.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="95.5" y="295.2935">error</text><path d="M272,313.3594 L272,338.3594 L404,338.3594 L404,323.3594 L394,313.3594 L272,313.3594 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394,313.3594 L394,323.3594 L404,323.3594 L394,313.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="278" y="330.4263">Close Connection</text><polygon fill="#A80036" points="89.5,371.625,79.5,375.625,89.5,379.625,85.5,375.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="375.625" y2="375.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="95.5" y="370.5591">return server cookie</text><polygon fill="#A80036" points="328.5,400.7578,338.5,404.7578,328.5,408.7578,332.5,404.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="334.5" y1="404.7578" y2="404.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="85.5" y="399.6919">send_client_proof()</text><path d="M262,417.7578 L262,442.7578 L415,442.7578 L415,427.7578 L405,417.7578 L262,417.7578 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M405,417.7578 L405,427.7578 L415,427.7578 L405,417.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="268" y="434.8247">Evaluate Client Proof</text><path d="M40,458.8906 L104,458.8906 L104,465.8906 L94,475.8906 L40,475.8906 L40,458.8906 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="458.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="471.9575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="119" y="471.1011">[Invalid Proof]</text><polygon fill="#A80036" points="89.5,493.1563,79.5,497.1563,89.5,501.1563,85.5,497.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="497.1563" y2="497.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="95.5" y="492.0903">error</text><path d="M272,510.1563 L272,535.1563 L404,535.1563 L404,520.1563 L394,510.1563 L272,510.1563 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394,510.1563 L394,520.1563 L404,520.1563 L394,510.1563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="278" y="527.2231">Close Connection</text><polygon fill="#A80036" points="89.5,568.4219,79.5,572.4219,89.5,576.4219,85.5,572.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="572.4219" y2="572.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="95.5" y="567.356">return</text><path d="M12,587.4219 L89,587.4219 L89,594.4219 L79,604.4219 L12,604.4219 L12,587.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="603.5234" style="stroke: #000000; stroke-width: 2.0;" width="463" x="12" y="587.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="27" y="600.4888">loop</text><polygon fill="#A80036" points="328.5,621.6875,338.5,625.6875,328.5,629.6875,332.5,625.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="334.5" y1="625.6875" y2="625.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="85.5" y="620.6216">request_endpoint_challenge()</text><path d="M249,638.6875 L249,663.6875 L427,663.6875 L427,648.6875 L417,638.6875 L249,638.6875 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M417,638.6875 L417,648.6875 L427,648.6875 L417,638.6875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="255" y="655.7544">Evaluate Endpoint String</text><path d="M40,679.8203 L104,679.8203 L104,686.8203 L94,696.8203 L40,696.8203 L40,679.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="679.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="692.8872">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="119" y="692.0308">[Invalid Endpoint]</text><polygon fill="#A80036" points="89.5,714.0859,79.5,718.0859,89.5,722.0859,85.5,718.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="718.0859" y2="718.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="95.5" y="713.02">error</text><path d="M272,731.0859 L272,756.0859 L404,756.0859 L404,741.0859 L394,731.0859 L272,731.0859 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394,731.0859 L394,741.0859 L404,741.0859 L394,731.0859 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="278" y="748.1528">Close Connection</text><path d="M269,777.2188 L269,802.2188 L408,802.2188 L408,787.2188 L398,777.2188 L269,777.2188 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M398,777.2188 L398,787.2188 L408,787.2188 L398,777.2188 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="275" y="794.2856">Evaluate Allow-List</text><path d="M40,818.3516 L104,818.3516 L104,825.3516 L94,835.3516 L40,835.3516 L40,818.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="818.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="831.4185">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="119" y="830.562">[Existing Contact]</text><polygon fill="#A80036" points="89.5,852.6172,79.5,856.6172,89.5,860.6172,85.5,856.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="856.6172" y2="856.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="95.5" y="851.5513">return</text><polygon fill="#A80036" points="89.5,888.75,79.5,892.75,89.5,896.75,85.5,892.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="892.75" y2="892.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="95.5" y="887.6841">return challenge</text><polygon fill="#A80036" points="328.5,917.8828,338.5,921.8828,328.5,925.8828,332.5,921.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="334.5" y1="921.8828" y2="921.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="85.5" y="916.8169">send_endpoint_challenge_response()</text><path d="M22,934.8828 L22,959.8828 L392,959.8828 L392,944.8828 L382,934.8828 L22,934.8828 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M382,934.8828 L382,944.8828 L392,944.8828 L382,934.8828 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="349" x="28" y="951.9497">Some time may pass as the Server processes request</text><path d="M40,976.0156 L104,976.0156 L104,983.0156 L94,993.0156 L40,993.0156 L40,976.0156 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="385" x="40" y="976.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="55" y="989.0825">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="119" y="988.2261">[Server Rejects Request]</text><polygon fill="#A80036" points="89.5,1010.2813,79.5,1014.2813,89.5,1018.2813,85.5,1014.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="1014.2813" y2="1014.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="95.5" y="1009.2153">error</text><path d="M272,1027.2813 L272,1052.2813 L404,1052.2813 L404,1037.2813 L394,1027.2813 L272,1027.2813 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M394,1027.2813 L394,1037.2813 L404,1037.2813 L394,1027.2813 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="278" y="1044.3481">Close Connection</text><path d="M239,1073.4141 L239,1098.4141 L437,1098.4141 L437,1083.4141 L427,1073.4141 L239,1073.4141 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M427,1073.4141 L427,1083.4141 L437,1083.4141 L427,1073.4141 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="245" y="1090.481">Adds the Client to Allow-List</text><polygon fill="#A80036" points="89.5,1124.6797,79.5,1128.6797,89.5,1132.6797,85.5,1128.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="83.5" x2="339.5" y1="1128.6797" y2="1128.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="95.5" y="1123.6138">return service id</text><path d="M215,1141.6797 L215,1181.6797 L461,1181.6797 L461,1151.6797 L451,1141.6797 L215,1141.6797 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M451,1141.6797 L451,1151.6797 L461,1151.6797 L451,1141.6797 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="221" y="1158.7466">Maintains connection to allow client</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="221" y="1173.8794">to make more endpoint requests</text><path d="M10,1202.9453 L10,1227.9453 L142,1227.9453 L142,1212.9453 L132,1202.9453 L10,1202.9453 " fill="#FBFB77" filter="url(#fl97i9wnsyf5c)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M132,1202.9453 L132,1212.9453 L142,1212.9453 L132,1202.9453 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="16" y="1220.0122">Close Connection</text><!--
@startuml
participant Client
participant "Introduction Server" as Server

Client->Server: begin_handshake()

    note over Server: Evaluate Protocol Version

    alt Unsupported Version
        Client<-Server: error
        note over Server: Close Connection
    end

    note over Server: Check Client Block-List

    alt Client Blocked
        Client<-Server: error
        note over Server: Close Connection
    end

Client<-Server: return server cookie

Client->Server: send_client_proof()

    note over Server: Evaluate Client Proof

    alt Invalid Proof
        Client<-Server: error
        note over Server: Close Connection
    end

Server->Client: return

loop
    Client->Server: request_endpoint_challenge()

        note over Server: Evaluate Endpoint String
        alt Invalid Endpoint
            Client<-Server: error
            note over Server: Close Connection
        end

        note over Server: Evaluate Allow-List
        alt Existing Contact
            Client<-Server: return
        end

        Client<-Server: return challenge

    Client->Server: send_endpoint_challenge_response()

        note over Client, Server: Some time may pass as the Server processes request

        alt Server Rejects Request
            Client<-Server: error
            note over Server: Close Connection
        end

        note over Server: Adds the Client to Allow-List

        Client<-Server: return service id

    note over Server
        Maintains connection to allow client
        to make more endpoint requests
    endnote
end
        note over Client: Close Connection
@enduml

PlantUML version 1.2018.13(Mon Nov 26 17:11:51 UTC 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.15+10-Ubuntu-0ubuntu0.20.04.1
Operating System: Linux
OS Version: 5.13.0-40-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
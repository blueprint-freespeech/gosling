<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Tor-Interface"><title>tor_interface - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="tor_interface" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.1 (3f5fd8dd4 2024-08-06)" data-channel="1.80.1" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../tor_interface/index.html">tor_interface</a><span class="version">0.3.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">tor_interface</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/tor_interface/lib.rs.html#1-30">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="tor-interface"><a class="doc-anchor" href="#tor-interface">§</a>Tor-Interface</h2>
<p>Developer-friendly crate providing connectivity to the <a href="https://en.wikipedia.org/wiki/Tor_(network)">Tor Network</a> and functionality for interacting with Tor-specific cryptographic types.</p>
<p>This crate is <em>not</em> meant to be a general purpose Tor Controller nor does it aim to expose all of the functionality of the underlying Tor implementations. This crate also does not implement any of the Tor Network functionality itself, instead wrapping lower-level implementations.</p>
<h3 id="overview"><a class="doc-anchor" href="#overview">§</a>Overview</h3>
<p>The <code>tor-interface</code> crate provides the <code>TorProvider</code> trait with 3 concrete implementations:</p>
<ul>
<li>ArtiClientTorClient: an experimental wrapper around the <a href="https://crates.io/crates/arti-client"><code>arti-client</code></a> crate; enabled using the <strong>arti-client-tor-provider</strong> feature flag.</li>
<li>LegacyTorClient: a wrapper around either an owned or system-provided legacy c-tor daemon (aka ‘little-t tor’) with some basic configuration options; enabled using the <strong>legacy-tor-provider</strong> feature flag.</li>
<li>MockTorClient: an in-process, mock implementation which makes no actual connections outside of localhost; enabled with the <strong>mock-tor-provider</strong> feature flag.</li>
</ul>
<p>The <code>TorProvider</code> trait defines methods for connecting to various types of target addresses (ip, domains, and onion-services) and for creating onion-services.</p>
<h3 id="-warning-"><a class="doc-anchor" href="#-warning-">§</a>⚠ Warning ⚠</h3>
<p>The <strong>arti-client-tor-provider</strong> feature is experimental is not fully implemented. It also depends on the <a href="https://crates.io/crates/arti-client"><code>arti-client</code></a> crate which is still under active development and is generally not yet ready for production use.</p>
<h3 id="usage"><a class="doc-anchor" href="#usage">§</a>Usage</h3>
<p>The following code snippet creates a <code>LegacyTorClient</code> which starts a bundled tor daemon, bootstraps, and attempts to connect to <a href="www.example.com">www.example.com</a>.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// construct legacy tor client config
</span><span class="kw">let </span>tor_path = std::path::PathBuf::from_str(<span class="string">"/usr/bin/tor"</span>).unwrap();
<span class="kw">let </span><span class="kw-2">mut </span>data_path = std::env::temp_dir();
data_path.push(<span class="string">"tor_data"</span>);

<span class="kw">let </span>tor_config = LegacyTorClientConfig::BundledTor {
    tor_bin_path: tor_path,
    data_directory: data_path,
    proxy_settings: <span class="prelude-val">None</span>,
    allowed_ports: <span class="prelude-val">None</span>,
    pluggable_transports: <span class="prelude-val">None</span>,
    bridge_lines: <span class="prelude-val">None</span>,
};
<span class="comment">// create client from config
</span><span class="kw">let </span><span class="kw-2">mut </span>tor_client = LegacyTorClient::new(tor_config).unwrap();

<span class="comment">// bootstrap tor
</span><span class="kw">let </span><span class="kw-2">mut </span>bootstrap_complete = <span class="bool-val">false</span>;
<span class="kw">while </span>!bootstrap_complete {
    <span class="kw">for </span>event <span class="kw">in </span>tor_client.update().unwrap().iter() {
        <span class="kw">match </span>event {
            TorEvent::BootstrapComplete =&gt; {
                bootstrap_complete = <span class="bool-val">true</span>;
            },
            <span class="kw">_ </span>=&gt; {},
        }
    }
}

<span class="comment">// connect to example.com
</span><span class="kw">let </span>target_addr = TargetAddr::from_str(<span class="string">"www.example.com:80"</span>).unwrap();
<span class="kw">let </span><span class="kw-2">mut </span>stream: OnionStream = tor_client.connect(target_addr, <span class="prelude-val">None</span>).unwrap();
<span class="comment">// and convert to a std::net::TcpStream
</span><span class="kw">let </span>stream: TcpStream = stream.into();</code></pre></div>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="arti_client_tor_client/index.html" title="mod tor_interface::arti_client_tor_client">arti_client_tor_client</a></div><div class="desc docblock-short">Implementation of an in-process <a href="https://crates.io/crates/arti-client"><code>arti-client</code></a>-based <code>TorProvider</code></div></li><li><div class="item-name"><a class="mod" href="censorship_circumvention/index.html" title="mod tor_interface::censorship_circumvention">censorship_circumvention</a></div><div class="desc docblock-short">Censorship circumvention configuration for pluggable-transports and bridge settings</div></li><li><div class="item-name"><a class="mod" href="legacy_tor_client/index.html" title="mod tor_interface::legacy_tor_client">legacy_tor_client</a></div><div class="desc docblock-short">Implementation of an out-of-process legacy <a href="https://gitlab.torproject.org/tpo/core/tor">c-tor daemon</a>-based <code>TorProvider</code></div></li><li><div class="item-name"><a class="mod" href="legacy_tor_version/index.html" title="mod tor_interface::legacy_tor_version">legacy_tor_version</a></div><div class="desc docblock-short">Legacy c-tor daemon version.</div></li><li><div class="item-name"><a class="mod" href="mock_tor_client/index.html" title="mod tor_interface::mock_tor_client">mock_tor_client</a></div><div class="desc docblock-short">Implementation of a local, in-process, mock <code>TorProvider</code> for testing.</div></li><li><div class="item-name"><a class="mod" href="proxy/index.html" title="mod tor_interface::proxy">proxy</a></div><div class="desc docblock-short">Proxy settings</div></li><li><div class="item-name"><a class="mod" href="tor_crypto/index.html" title="mod tor_interface::tor_crypto">tor_crypto</a></div><div class="desc docblock-short">Tor-specific cryptographic primitives, operations, and conversion functions.</div></li><li><div class="item-name"><a class="mod" href="tor_provider/index.html" title="mod tor_interface::tor_provider">tor_provider</a></div><div class="desc docblock-short">Traits and types for connecting to the Tor Network.</div></li></ul></section></div></main></body></html>